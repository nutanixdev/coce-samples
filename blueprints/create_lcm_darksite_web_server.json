{"status":{},"contains_secrets":false,"product_version":"3.6.2","spec":{"description":"Deploy dark site web server & reconfigure LCM for local web server updates","resources":{"client_attrs":{"None":{"Profile":{"Default":{"Action":{},"dsl_name":"Default"}},"Package":{"CentosImage":{"Action":{},"dsl_name":"CentosImage"},"BasicLinuxPackage":{"Action":{},"dsl_name":"BasicLinuxPackage"}},"Substrate":{"BasicLinuxVm":{"Action":{},"AhvVm":{"vm-@@{calm_array_index}@@-@@{calm_time}@@":{"dsl_name":"vmcalm_array_indexcalm_time"}},"dsl_name":"BasicLinuxVm"}},"Service":{"BasicLinux":{"Action":{},"dsl_name":"BasicLinux"}},"Deployment":{"basiclinuxvm_deployment":{"Action":{},"dsl_name":"basiclinuxvm_deployment"}}},"basiclinuxvm_deployment":{"y":-580,"x":-239}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":true,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[{"kind":"app_task","name":"Configure Base VM"},{"kind":"app_task","name":"Configure Storage"}],"name":"DAG_Task_for_Service_BasicLinux_action_create","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Configure Base VM"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Configure Storage"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Configure Base VM","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# update centos packages\nsudo yum -y update\n\n# install some useful packages\nsudo yum -y install git bash-completion vim net-tools bind-utils wget firewalld unzip\n\n# set the hostname\nsudo hostnamectl set-hostname @@{HOSTNAME}@@","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Configure Storage","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# create single partition on sdb\n(\necho o # Create a new empty DOS partition table\necho n # Add a new partition\necho p # Primary partition\necho 1 # Partition number\necho   # First sector (Accept default: 1)\necho   # Last sector (Accept default: varies)\necho w # Write changes\n) | sudo fdisk \/dev\/sdb\nsudo mkfs.ext4 \/dev\/sdb1\nsudo mkdir -p \/mnt\/lcm\nsudo mount -t ext4 \/dev\/sdb1 \/mnt\/lcm","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"Runbook_for_Service_BasicLinux_action_create","main_task_local_reference":{"kind":"app_task","name":"DAG_Task_for_Service_BasicLinux_action_create"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":true,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[{"kind":"app_task","name":"Get LCM eTag"},{"kind":"app_task","name":"Revert LCM to Nutanix Portal"}],"name":"DAG_Task_for_Service_BasicLinux_action_delete","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get LCM eTag"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Revert LCM to Nutanix Portal"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Get LCM eTag","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","headers":[],"url":"https:\/\/localhost:9440\/api\/lcm\/v4.0.a1\/resources\/config","response_paths":{"current_etag":"$.metadata.ETag"},"retry_interval":1,"method":"GET","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"Prism Central Admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Revert LCM to Nutanix Portal","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"isDarksite\": false,\n  \"enableHttps\": true\n}","headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"If-Match","value":"@@{current_etag}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"message_list":[],"options":{}}],"url":"https:\/\/localhost:9440\/api\/lcm\/v4.0.a1\/resources\/config","response_paths":{},"retry_interval":1,"method":"PUT","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"Prism Central Admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]}],"description":"","name":"Runbook_for_Service_BasicLinux_action_delete","main_task_local_reference":{"kind":"app_task","name":"DAG_Task_for_Service_BasicLinux_action_delete"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":true,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"DAG_Task_for_Service_BasicLinux_action_start","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"Runbook_for_Service_BasicLinux_action_start","main_task_local_reference":{"kind":"app_task","name":"DAG_Task_for_Service_BasicLinux_action_start"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":true,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"DAG_Task_for_Service_BasicLinux_action_stop","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"Runbook_for_Service_BasicLinux_action_stop","main_task_local_reference":{"kind":"app_task","name":"DAG_Task_for_Service_BasicLinux_action_stop"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":true,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"DAG_Task_for_Service_BasicLinux_action_restart","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"Runbook_for_Service_BasicLinux_action_restart","main_task_local_reference":{"kind":"app_task","name":"DAG_Task_for_Service_BasicLinux_action_restart"},"variable_list":[]},"name":"action_restart"},{"description":"System action for deleting an application. Does not delete created VMs","type":"system","critical":true,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"DAG_Task_for_Service_BasicLinux_action_soft_delete","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"Runbook_for_Service_BasicLinux_action_soft_delete","main_task_local_reference":{"kind":"app_task","name":"DAG_Task_for_Service_BasicLinux_action_soft_delete"},"variable_list":[]},"name":"action_soft_delete"}],"depends_on_list":[],"name":"BasicLinux","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"BasicLinuxVm"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"d0ea3d51_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0b0c2f05_runbook","main_task_local_reference":{"kind":"app_task","name":"d0ea3d51_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"BasicLinuxVm"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"cb3a0f31_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"73f62882_runbook","main_task_local_reference":{"kind":"app_task","name":"cb3a0f31_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"BasicLinuxVm","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"120","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"admin"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"lcm-web-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","vpc_reference":null,"ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"Primary","uuid":"c0bc09e7-6c04-4c59-9213-c14806927a6e"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":8192,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: @@{admin.username}@@\n    ssh-authorized-keys:\n      - @@{admin.public_key}@@\n    sudo:\n    - ALL=(ALL) NOPASSWD:ALL\nruncmd:\n  - update-crypto-policies --set DEFAULT:SHA1\n  - systemctl restart --no-block sshd.service"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"8b578a48-8225-4e72-b4e8-0c9a527b2401","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"LEGACY","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentosImage_2211","uuid":"fa221c43-b9a5-4237-a193-f79790543a35"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":102400,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":{"kind":"cluster","type":"","name":"Dev","uuid":"0005f2f7-eee7-1995-6145-ac1f6b35fe5e"},"categories":{}},"variable_list":[]}],"credential_definition_list":[{"username":"admin","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"admin","cred_class":"static"},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"Prism Central Admin","cred_class":"static"}],"package_definition_list":[{"description":"","action_list":[],"type":"CUSTOM","service_local_reference_list":[{"kind":"app_service","name":"BasicLinux"}],"name":"BasicLinuxPackage","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"BasicLinuxPackage___install___dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"BasicLinuxPackage___install___runbook","main_task_local_reference":{"kind":"app_task","name":"BasicLinuxPackage___install___dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"DAG_Task_for_Package_BasicLinuxPackage_action_uninstall","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"Runbook_for_Package_BasicLinuxPackage_action_uninstall","main_task_local_reference":{"kind":"app_task","name":"DAG_Task_for_Package_BasicLinuxPackage_action_uninstall"},"variable_list":[]},"upgrade_runbook":{}},"variable_list":[]},{"description":"https:\/\/cloud.centos.org\/centos\/7\/images\/","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"CentosImage_2211","version":"","options":{"type":"","name":"CentOS-7.8-2211","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"https:\/\/cloud.centos.org\/centos\/7\/images\/CentOS-7-x86_64-GenericCloud-2211.qcow2","version":{"product_version":"7.8","type":"","product_name":"CentOS"},"architecture":"X86_64","type":""},"description":""},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"basiclinuxvm_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"BasicLinuxPackage"}],"substrate_local_reference":{"kind":"app_substrate","name":"BasicLinuxVm"},"options":{"type":""},"variable_list":[],"description":""}],"environment_reference_list":[],"application_url":"","description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[{"kind":"app_task","name":"Install NGINX"},{"kind":"app_task","name":"Configure NGINX"},{"kind":"app_task","name":"Configure Firewall"},{"kind":"app_task","name":"Configure LCM Web Server"},{"kind":"app_task","name":"Download LCM Updates"},{"kind":"app_task","name":"Get LCM eTag"},{"kind":"app_task","name":"Reconfigure LCM for Dark Site Web Server"}],"name":"66ae7ab8_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install NGINX"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Configure NGINX"}},{"from_task_reference":{"kind":"app_task","name":"Configure LCM Web Server"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Download LCM Updates"}},{"from_task_reference":{"kind":"app_task","name":"Download LCM Updates"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Get LCM eTag"}},{"from_task_reference":{"kind":"app_task","name":"Get LCM eTag"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Reconfigure LCM for Dark Site Web Server"}},{"from_task_reference":{"kind":"app_task","name":"Configure NGINX"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Configure Firewall"}},{"from_task_reference":{"kind":"app_task","name":"Configure Firewall"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Configure LCM Web Server"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Install NGINX","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# install, start and enable nginx\nsudo yum -y install epel-release\nsudo yum -y install nginx\nsudo systemctl start nginx\nsudo systemctl enable nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Configure NGINX","attrs":{"exit_status":[],"script":"# configure some best-practice nginx settings\n\n#################################################\n#                                               #\n# THESE ARE GENERAL SETTINGS ONLY AND WILL NEED #\n# NEED TO BE CAREFULLY CHECKED BEFORE USE IN A  #\n# PRODUCTION ENVIRONMENT!                       #\n#                                               #\n# SERIOUSLY, CHECK THEM!  :)                    #\n#                                               #\n#################################################\n\n# set the number of nginx worker processes to be the same as the number of cores in this system\nPROCS=`sudo grep processor \/proc\/cpuinfo | wc -l`\nsudo sed -i -- \"s\/worker_processes.*\/worker_processes $PROCS;\/\" \/etc\/nginx\/nginx.conf\n\n# set the number of worker connections to the max allowed by nginx\n# this allows the server to operate at max potential, if required\nsudo sed -i -- 's\/worker_connections.*\/worker_connections 1024;\/' \/etc\/nginx\/nginx.conf\n\n# enable gzip compression\necho \"gzip on;\ngzip_proxied any;\ngzip_types text\/plain text\/xml text\/css application\/x-javascript;\ngzip_vary on;\ngzip_disable \\\"MSIE [1-6]\\.(?!.*SV1)\\\";\" | sudo tee \/etc\/nginx\/conf.d\/gzip.conf\n\n# setup cache expiry for static files\necho \"location ~*  \\.(jpg|jpeg|png|gif|ico|css|js)\\$ {\n   expires @@{STATIC_EXPIRATION_DAYS}@@d;\n}\" | sudo tee \/etc\/nginx\/default.d\/expires.conf\n\n# set the client buffers\n# this is critical on busy systems\necho \"client_body_buffer_size  1K;\nclient_header_buffer_size 1k;\nclient_max_body_size 1k;\nlarge_client_header_buffers 2 1k;\" | sudo tee \/etc\/nginx\/conf.d\/buffer.conf\n\n# set the client timeouts - performance improvement under certain circumstances\necho \"client_body_timeout 12;\nclient_header_timeout 12;\nsend_timeout 10;\" | sudo tee \/etc\/nginx\/conf.d\/timeout.conf\n\n# set the keepalive timeout separately\n# done this way because the above settings are not in nginx.conf by default, but keepalive_timeout is\n# this means we can modify it, rather than setting a new value\nsudo sed -i -- 's\/keepalive_timeout.*\/keepalive_timeout 15;\/' \/etc\/nginx\/nginx.conf\n\n# configure site root\nsudo mkdir -p \/mnt\/lcm\/web\nsudo sed -i -- 's\/\\\/usr\\\/share\\\/nginx\\\/html\/\\\/mnt\\\/lcm\\\/web\/g' \/etc\/nginx\/nginx.conf\n\n# customise NGINX: log all NGINX access requests\nsudo sed -i -- 's\/access_log.*off;\/access_log \\\/var\\\/log\\\/nginx\\\/access.log;\/g' \/etc\/nginx\/nginx.conf\n# customise NGINX: enable directory listing (LCM requirement)\nsudo sed -i -- '\/root.*;\/a \\\\tautoindex on;' \/etc\/nginx\/nginx.conf\n\n\n# configure selinux to allow Nginx in Permissive mode\nsudo semanage permissive -a httpd_t","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Configure Firewall","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# configure the firewall to allow HTTP requests (port 80, by default)\nsudo systemctl start firewalld\nsudo systemctl enable firewalld\nsudo firewall-cmd --permanent --add-service=http\nsudo firewall-cmd --reload","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Configure LCM Web Server","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# create LCM release directory\nsudo mkdir -p -m 755 \/mnt\/lcm\/web\/release\n\n# create temporary LCM download location\nsudo mkdir -p -m 755 \/mnt\/lcm\/download\n\n# restart NGINX to make sure all previous changes are loaded\nsudo systemctl restart nginx","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Download LCM Updates","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# download LCM support files as per short-term download links\ncd \/mnt\/lcm\/download\n\n# download LCM framework\/dark site bundle\nsudo curl -L -O \"@@{FRAMEWORK_BUNDLE}@@\"\n\n# pre-seed the LCM update files\n# this is for demo only!\n\nfor i in \"@@{MSP}@@\" \"@@{OBJECTS}@@\" \"@@{NKE}@@\" \"@@{FOUNDATION}@@\" \"@@{FLOW_PE}@@\" \"@@{FLOW_PC}@@\" \"@@{FILES_ANALYTICS}@@\" \"@@{FILES}@@\" \"@@{CMU}@@\" \"@@{SELF_SERVICE_EPSILON}@@\" \"@@{SELF_SERVICE_NUCALM}@@\" \"@@{AHV}@@\" \"@@{AOS}@@\" \"@@{FIRMWARE}@@\" \"@@{NCC}@@\"\ndo\nsudo curl -L -O $i\ndone\n\n# extract LCM dark site bundles into place\nfor i in .\/*.tar.gz\ndo\nsudo tar xzvf $i --directory \/mnt\/lcm\/web\/release\ndone\n\n# extract Self Service dark site bundles into place\nfor i in .\/*.zip\ndo\nsudo unzip $i -d \/mnt\/lcm\/web\/release\ndone\n\n# comment the next 2 lines to NOT remove downloaded LCM files\nsudo rm *.tar.gz\nsudo rm *.zip","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"admin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Get LCM eTag","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","headers":[],"url":"https:\/\/localhost:9440\/api\/lcm\/v4.0.a1\/resources\/config","response_paths":{"current_etag":"$.metadata.ETag"},"retry_interval":1,"method":"GET","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"Prism Central Admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"BasicLinux"},"retries":"0","description":"","inherit_target":false,"child_tasks_local_reference_list":[],"name":"Reconfigure LCM for Dark Site Web Server","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"isDarksite\": true,\n  \"enableHttps\": false,\n  \"url\": \"http:\/\/@@{address}@@\/release\"\n}","headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"If-Match","value":"@@{current_etag}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"message_list":[],"options":{}}],"url":"https:\/\/localhost:9440\/api\/lcm\/v4.0.a1\/resources\/config","response_paths":{},"retry_interval":1,"method":"PUT","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"Prism Central Admin"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]}],"description":"","name":"89b202ec_runbook","main_task_local_reference":{"kind":"app_task","name":"66ae7ab8_dag"},"variable_list":[]},"name":"Reconfigure LCM"}],"name":"Default","restore_config_list":[],"snapshot_config_list":[],"patch_list":[],"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"STATIC_EXPIRATION_DAYS","value":"365","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"HOSTNAME","value":"lcm-web-server","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"AOS","value":"http:\/\/10.42.250.116\/lcm\/lcm_nos_6.6.2.5.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"AHV","value":"http:\/\/10.42.250.116\/lcm\/lcm_ahv_el7.nutanix.20220304.10057.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SELF_SERVICE_NUCALM","value":"http:\/\/10.42.250.116\/lcm\/NuCalm-3.6.2.zip","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SELF_SERVICE_EPSILON","value":"http:\/\/10.42.250.116\/lcm\/Epsilon-3.6.2.zip","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"CMU","value":"http:\/\/10.42.250.116\/lcm\/lcm_cmu_2.0.3.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FILES","value":"http:\/\/10.42.250.116\/lcm\/lcm_file_server_4.3.0.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FILES_ANALYTICS","value":"http:\/\/10.42.250.116\/lcm\/lcm_file_analytics_3.2.1.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FLOW_PC","value":"http:\/\/10.42.250.116\/lcm\/lcm_flow_pc_3.0.0.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FLOW_PE","value":"http:\/\/10.42.250.116\/lcm\/lcm_flow_cvm_3.0.0.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FOUNDATION","value":"http:\/\/10.42.250.116\/lcm\/lcm_foundation_5.4.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"NKE","value":"http:\/\/10.42.250.116\/lcm\/lcm_NKE_2.8.0.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MSP","value":"http:\/\/10.42.250.116\/lcm\/lcm_darksite_msp-2.4.3.2.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"OBJECTS","value":"http:\/\/10.42.250.116\/lcm\/objects-4.0.tar.gz","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FRAMEWORK_BUNDLE","value":"http:\/\/10.42.250.116\/lcm\/lcm_dark_site_bundle_2.6.0.2.36541.tar.gz","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"FIRMWARE","value":"http:\/\/10.42.250.116\/lcm\/lcm_nx_2.21.0.tar.gz","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"NCC","value":"http:\/\/10.42.250.116\/lcm\/lcm_ncc_4.6.3.1.tar.gz","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"admin"},"type":"USER"},"name":"Create LCM Dark Site Web Server"},"api_version":"3.0","metadata":{"last_update_time":"1684285082031575","kind":"blueprint","spec_version":93,"creation_time":"1678252101369964","name":"Create LCM Dark Site Web Server"}}